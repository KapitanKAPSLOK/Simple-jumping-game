(()=>{"use strict";class e{constructor(e,t="black",s="red",i=100){this.refreshIntervalMs=i,this.display=e,this.color=t,this.stopColor=s,this.reset()}getTime(){return null===this.endTime?(new Date).getTime()-this.startTime+this.previousTime:this.endTime-this.startTime+this.previousTime}start(){clearInterval(this.intervalId),this.reset(),this.intervalId=setInterval((()=>{this.update()}),this.refreshIntervalMs)}reasume(){this.display.style.color=this.color,clearInterval(this.intervalId),this.intervalId=setInterval((()=>{this.update()}),this.refreshIntervalMs),null!==this.endTime&&(this.previousTime+=this.getTime(),this.endTime=null,this.startTime=(new Date).getTime())}stop(){clearInterval(this.intervalId),this.endTime=(new Date).getTime(),this.update(),this.display.style.color=this.stopColor}reset(){this.startTime=(new Date).getTime(),this.endTime=null,this.previousTime=0,this.display.innerText="0:00:00",this.display.style.color=this.color}update(){const t=this.getTime();this.display.innerText=e.parseTime(t)}static getDecisecondsPart(e){return Math.floor(e%1e3/100)}static getSecondsPart(e){return Math.floor(e%6e4/1e3)}static getMinutesPart(e){return Math.floor(e/6e4)}static parseTime(t){let s=`${e.getMinutesPart(t)}:`;const i=e.getSecondsPart(t);return s+=i<10?`0${i}:`:`${i}:`,s+=`${this.getDecisecondsPart(t)}`,s}}class t{constructor(e,t,s,i,a,h){this.x=e,this.y=t,this.width=s,this.height=i,this.speedXPxPerSec=a,this.speedYPxPerSec=h,this.div=document.createElement("div"),this.div.style.width=`${s}px`,this.div.style.height=`${i}px`,this.div.style.position="absolute",this.draw()}draw(){this.div.style.left=`${this.x}px`,this.div.style.bottom=`${this.y}px`}positionChange(e){this.x+=this.speedXPxPerSec*e,this.y+=this.speedYPxPerSec*e}updateState(e){this.positionChange(e)}}class s extends t{constructor(e,t=500){super(200,0,10,30,0,0),this.div.style.backgroundColor="red",this.jumpSpeed=t,this.g=e,window.addEventListener("keypress",(()=>this.jump()))}applyGravity(e){this.y>0?this.speedYPxPerSec-=e*this.g:(this.speedYPxPerSec=0,this.y=0)}jump(){0===this.speedYPxPerSec&&(this.speedYPxPerSec=this.jumpSpeed)}updateState(e){this.positionChange(e),this.applyGravity(e)}freeze(){window.removeEventListener("keypress",(()=>this.jump()))}isColliding(e){return!(this.x>e.x+e.width||e.x>this.x+this.width||this.y>e.y+e.height||e.y>this.y+this.height)}}class i extends t{constructor(e,t,s,i){super(window.innerWidth-e,0,e,t,s,i),this.div.style.backgroundColor="black",this.speedXPxPerSec=s,this.speedYPxPerSec=i}}class a{constructor(t,s,i){this.g=1400,this.obstaclesSpeedPxPerSec=-300,this.obstacleMinTimeoutMs=400,this.obstacleMaxTimeoutMs=3e3,this.gameOn=!1,this.gameArea=s,this.refreashRate=1e3/t,this.obstacles=new Set,this.timer=new e(i),this.addPlayer()}addPlayer(){void 0===this.player&&(this.player=new s(this.g),this.gameArea.appendChild(this.player.div))}removeIfOutsideGameArea(e){e.x+e.width<0&&(this.obstacles.delete(e),this.gameArea.removeChild(e.div))}calculateFrame(){this.player.updateState(this.refreashRate/1e3),this.player.draw(),this.obstacles.forEach((e=>{e.updateState(this.refreashRate/1e3),e.draw(),this.player.isColliding(e)&&this.endGame(),this.removeIfOutsideGameArea(e)}))}addObstacle(e,t,s,a){const h=new i(e,t,s,a);this.gameArea.appendChild(h.div),this.obstacles.add(h)}generateObstacles(){setTimeout((()=>{this.gameOn&&(this.addObstacle(20,50,this.obstaclesSpeedPxPerSec,0),this.generateObstacles())}),Math.floor(Math.random()*(this.obstacleMaxTimeoutMs-this.obstacleMinTimeoutMs))+this.obstacleMinTimeoutMs)}startGame(){this.gameOn=!0,this.generateObstacles(),this.timer.start(),this.intervalId=setInterval((()=>{this.calculateFrame()}),this.refreashRate)}endGame(){this.gameOn=!1,clearInterval(this.intervalId),this.timer.stop(),this.player.freeze()}}const h=document.getElementById("game"),r=document.getElementById("timer");null!==h&&null!==r&&new a(50,h,r).startGame()})();